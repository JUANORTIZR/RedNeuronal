<div class="card bg-dark text-white " *ngIf="!login">
  <img src="../assets/24_vector_image.jpg" class="card-img" alt="...">
  <div class="card-img-overlay ">
    <div class="card-body" id="login" *ngIf="!login">

      <div class="card text-bg-dark  my-5" id="cuerpoLogin">
        <div class="card-header">
          <h5 class="fw-bold fst-italic text-center">Login</h5>
        </div>
        <div class="card-body">
          <div class="input-group mb-3">
            <label class="input-group-text" for="inputGroupSelect01">Tipo de usuario</label>
            <select (change)="getUsuario($event)" class="form-select" id="inputGroupSelect01">
              <option selected>Seleccione...</option>
              <option value="Admin">Admin</option>
              <option value="Programador">Programador</option>
              <option value="Usuario">Usuario</option>
            </select>
          </div>
          <div class="input-group">
            <span class="input-group-text" id="inputGroup-sizing-default">Clave </span>
            <input type="text" [(ngModel)]="usuario.clave" class="form-control" aria-label="Sizing example input"
              aria-describedby="inputGroup-sizing-default">
          </div>
          <div class="d-grid my-2 gap-2 col-6 mx-auto">
            <button (click)="ingresar()" class="btn btn-success" type="button">Ingresar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="card text-bg-dark mb-3" *ngIf="login">
  <div class="card-header">
    <nav class="navbar navbar-expand-lg bg-dark">
      <div class="container-fluid">
        <ul class="nav nav-pills card-header-pills">
          <li class="nav-item" *ngIf="usuario.nombreUsuario=='Admin' || usuario.nombreUsuario=='Programador'">
            <a class="nav-link active" *ngIf="simulacion==false" aria-current="true" href="#">Entrenamieno</a>
            <a class="nav-link" *ngIf="simulacion" (click)="simulacion = false" aria-current="true"
              href="#">Entrenamieno</a>
          </li>
          <li class="nav-item"
            *ngIf="usuario.nombreUsuario=='Admin' || usuario.nombreUsuario=='Programador' || usuario.nombreUsuario=='Usuario' ">
            <a class="nav-link active" *ngIf="simulacion" href="#">Simulacion</a>
            <a class="nav-link" *ngIf="simulacion==false" (click)="simulacion = true" href="#">Simulacion</a>
          </li>
        </ul>
        <span class="navbar-text" (click)="login = false">
          <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="red" class="bi bi-box-arrow-left" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"/>
            <path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
          </svg>
        </span>
      </div>
    </nav>
  </div>



  <div class="card-body" *ngIf="!simulacion && login">
    <h5 class="card-title text-center mb-3">Red neuronal unicapa (Perceptron/Adaline)</h5>

    <div class="shadow-sm p-3 mb-5 bg-body rounded row">
      <div class="row mb-2">
        <div class="col">
          <span class="badge bg-secondary">CARGAR DATOS</span>
        </div>
      </div>
      <div class="row">
        <div class="input-group mb-3">
          <input type="file" (change)="leerDatos($event)" class="form-control" id="inputGroupFile01">
          <button (click)="guardarPesosIniciales()" class="btn btn-outline-secondary" type="button"
            id="inputGroupFileAddon04">Descargar pesos iniciales</button>
        </div>
      </div>

      <div class="row mb-2">

        <div class="col">
          <span class="badge bg-secondary">PARAMETROS DE ENTRADA</span>
        </div>

      </div>
      <div class="row">
        <div class="col ms-5">
          <div class="text-nowrap bg-light border  " id="tituloCapa" style="width: 14rem;">
            Cantidad de entradas: {{totalEntradas}}
          </div>
        </div>
        <div class="col">
          <div class="text-nowrap bg-light border" id="tituloCapa" style="width: 14rem;">
            Cantidad de salidas: {{totalSalidas}}
          </div>
        </div>
        <div class="col">
          <div class="text-nowrap bg-light border" id="tituloCapa" style="width: 14rem;">
            Cantidad de patrones: {{totalPatrones}}
          </div>
        </div>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col">
        <span class="badge bg-secondary">CONFIGURACION DE LA RED</span>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="input-group mb-3">
          <label class="input-group-text" for="inputGroupSelect01">Tipo de red</label>
          <select disabled (change)="getTipoRed($event)" class="form-select" id="inputGroupSelect01">
            <option selected>Unicapa</option>
            <option value="Unicapa">Unicapa</option>
            <option value="Multicapa">Multicapa</option>
          </select>
        </div>
      </div>
      <div class="col">
        <div class="input-group mb-2">
          <label class="input-group-text" for="inputGroupSelect01">Modelo de la red</label>
          <select (change)="getModeloDeRed($event)" class="form-select" id="inputGroupSelect01">
            <option selected>--</option>
            <option value="PERCEPTRON">PERCEPTRON</option>
            <option value="ADALINE">ADALINE</option>
          </select>
        </div>
      </div>

    </div>

    <div class="row mb-3" *ngIf="this.tipoRed && this.tipoRed == 'Multicapa'">
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-sizing-default">Algoritmo de entrenamiento: </span>
          <input disabled type="text" [(ngModel)]="algoritmoDeEntrenamiento" class="form-control"
            aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
    </div>

    <div class="row" *ngIf="tipoRed=='Unicapa'">
      <div class="col">
        <div class="input-group mb-3">
          <label class="input-group-text" for="inputGroupSelect01">Función de activación</label>
          <select (change)="getFuncionDeActivacion($event)" class="form-select" id="inputGroupSelect01">
            <option *ngFor="let funcion of listaFuncionesActivacion" ngValue="funcion">{{funcion}}</option>
          </select>
        </div>
      </div>
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-sizing-default">Algoritmo de entrenamiento: </span>
          <input disabled type="text" [(ngModel)]="algoritmoDeEntrenamiento" class="form-control"
            aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
    </div>

    <div class="row" *ngIf="tipoRed=='Multicapa'">
      <div class="col">
        <div class="input-group mb-3">
          <label class="input-group-text" for="inputGroupSelect01">Cuantas capas?</label>
          <select (change)="getCantidadCapas($event)" class="form-select" id="inputGroupSelect01">
            <option selected>--</option>
            <option ngValue="1">1</option>
            <option ngValue="2">2</option>
            <option ngValue="3">3</option>
          </select>
        </div>
      </div>


      <div class="col-6">
        <div class="input-group mb-3">
          <label class="input-group-text" for="inputGroupSelect01">Funcion de activacion capa salida</label>
          <select (change)="getFuncionActvacionCapaSalida($event)" class="form-select" id="inputGroupSelect01">
            <option selected>--</option>
            <option *ngFor="let funcion of listaFuncionesActivacion" ngValue="funcion">{{funcion}}</option>
          </select>
        </div>
      </div>


    </div>
    <div *ngIf="this.tipoRed && this.tipoRed == 'Multicapa' && this.cantidadDeCapas!='--'"
      class="shadow-sm p-3 mb-5 mt-2 bg-body rounded">
      <div *ngFor="let capa of listaCapas;let i=index">
        <h6 id="tituloCapa">Capa {{i+1}}</h6>
        <div class="row">
          <div class="col-6">
            <div class="input-group">
              <span class="input-group-text" id="inputGroup-sizing-default">Cantidad de neuronas</span>
              <input (change)="getCantidadNeuronas(i,$event)" type="text" class="form-control"
                aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">

            </div>
          </div>

          <div class="col-6">
            <div class="input-group mb-3">
              <label class="input-group-text" for="inputGroupSelect01">Funcion de activacion</label>
              <select (change)="getFuncionActvacionMulticapa(i,$event)" class="form-select" id="inputGroupSelect01">
                <option selected>--</option>
                <option *ngFor="let funcion of listaFuncionesActivacion" ngValue="funcion">{{funcion}}</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mb-2">
      <div class="col">
        <span class="badge bg-secondary">PARAMETROS DE ENTRENAMIENTO</span>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-sizing-default">Numero de iteraciones</span>
          <input [(ngModel)]="numeroDeIteraciones" type="number" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">

        </div>
      </div>
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-sizing-default">Rata de aprendizaje</span>
          <input [(ngModel)]="rataDeAprendizaje" type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default" required>
          <div *ngIf="rataDeAprendizaje == '0'" class="valid-tooltip">
            Looks good!
          </div>
        </div>
      </div>
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-sizing-default">Error maximo permitido</span>
          <input [(ngModel)]="errorMaximoPermititdo" type="text" class="form-control" aria-label="Sizing example input"
            aria-describedby="inputGroup-sizing-default">
        </div>
      </div>
    </div>

    <!-- <a href="#" (click)="entrenarRed()" class="btn btn-success mt-2">Iniciar entrenamiento</a> -->

    <button (click)="entrenarRed()" type="button" class="btn btn-success mt-2" data-bs-toggle="modal"
      data-bs-target="#exampleModal">
      Iniciar entrenamiento
    </button>
    <!--  <h5 class="text-center mt-2">Grafica de error de iteracion vs error maximo permitido</h5>

    <div class="grafica">
      <div style="display: block">
        <canvas mdbChart [chartType]="chartType" [datasets]="chartDatasets" [labels]="chartLabels"
          [colors]="chartColors" [options]="chartOptions" [legend]="true" (chartHover)="chartHovered($event)"
          (chartClick)="chartClicked($event)">
        </canvas>
      </div>

    </div> -->

  </div>

  <div class="card-body" *ngIf="simulacion && login">
    <h5 class="card-title text-center mb-3">SIMULACION DE LA RED</h5>
    <div class="shadow-sm p-3 mb-5 bg-body rounded row">
      <div class="row">
        <div class="col-6">
          <div class="mb-2">
            <span class="badge bg-secondary">CARGAR BANCO DE DATOS</span>
          </div>
          <div class="input-group mb-3">
            <input type="file" (change)="leerDatos($event)" class="form-control" id="inputGroupFile01">
          </div>
        </div>
        <div class="col-6">
          <div class="mb-2">
            <span class="badge bg-secondary">CARGAR PESOS IDEALES</span>
          </div>
          <div class="input-group mb-3">
            <input type="file" (change)="leerPesos($event)" class="form-control" id="inputGroupFile01">
          </div>
        </div>


      </div>




    </div>
    <div class="row">
      <div class="col">
        <div class="input-group mb-3">
          <label class="input-group-text" for="inputGroupSelect01">Patron a simular</label>
          <select (change)="getPatron($event)" class="form-select" id="inputGroupSelect01">
            <option selected>Seleccione un patron</option>
            <option *ngFor="let item of datosDeEntrada; let i = index" [value]="i">{{item +" = "+ datosDeSalida[i]}}
            </option>
          </select>
        </div>
      </div>
      <div class="col">
        <div class="input-group">
          <span class="input-group-text" id="inputGroup-sizing-default">Patron </span>
          <input type="text" [(ngModel)]="patronSeleccionadoInput" class="form-control"
            aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
        </div>
      </div>

      <div class="col">
        <div class="input-group mb-2">
          <label class="input-group-text" for="inputGroupSelect01">Modelo de la red</label>
          <select (change)="getModeloDeRed($event)" class="form-select" id="inputGroupSelect01">
            <option selected>--</option>
            <option value="PERCEPTRON">PERCEPTRON</option>
            <option value="ADALINE">ADALINE</option>
          </select>
        </div>
      </div>
    </div>

    <button (click)="simularRed()" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
      Simular
    </button>

    <div class="row">
      <div class="col">
        <h5 class="text-center mt-2">Salida de la red vs salida deseada</h5>
        <div style="display: block">
          <canvas mdbChart [chartType]="chartTypeS" [datasets]="chartDatasetsS" [labels]="chartLabelsS"
            [colors]="chartColorsS" [options]="chartOptionsS" [legend]="true" (chartHover)="chartHovered($event)"
            (chartClick)="chartClicked($event)">
          </canvas>
        </div>
      </div>

    </div>

  </div>
  <div class="card-footer text-muted ">
    <h6 class="text-center" id="vea"> AJAM AJAM </h6>
  </div>
</div>


<!-- Button trigger modal -->


<!-- Modal -->
<div *ngIf="valido" class="modal fade" data-bs-backdrop="static" id="exampleModal" tabindex="-1"
  aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Graficas de entrenamiento</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col">
            <!-- <h5>grafica 1</h5> -->
            <div style="display: block">
              <canvas mdbChart [chartType]="chartType" [datasets]="chartDatasets" [labels]="chartLabels"
                [colors]="chartColors" [options]="chartOptions" [legend]="true" (chartHover)="chartHovered($event)"
                (chartClick)="chartClicked($event)">
              </canvas>
            </div>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cambiar configuracion de la red</button>
        <button type="button" (click)="guardarPesosIniciales()" class="btn btn-dark">Descargar pesos iniciales</button>
        <button type="button" (click)="entrenarRed()" class="btn btn-dark">Volver a entranar</button>
        <button type="button" (click)=" seguirIterando()" data-bs-toggle="tooltip" data-bs-placement="top"
          data-bs-custom-class="custom-tooltip" title="Iterar {{numeroDeIteraciones}} veces mas"
          class="btn btn-success">Seguir iterando</button>
      </div>
    </div>
  </div>
</div>



<!--Modal alert-->
<!-- Button trigger modal -->
<!-- <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
  Launch static backdrop modal
</button> -->

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Salida de la red</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Salida de la red <b>{{YR}}</b> vs salida deseada <b>{{datosDeSalida[patronSeleccionado]}}</b>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>
